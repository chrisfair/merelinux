# Maintainer: Jeremy Huntwork <jhuntwork@lightcubesolutions.com>

pkgname=(e2fsprogs)
pkgver=1.43.4
pkgrel=1
pkgdesc='Filesystem utilities for ext2, ext3 and ext4.'
arch=(x86_64)
url=http://e2fsprogs.sourceforge.net/
license=(GPL)
groups=(base)
depends=()
makedepends=(libattr-dev gettext libtool)
options=()
changelog=ChangeLog
source=(
    "https://www.kernel.org/pub/linux/kernel/people/tytso/${pkgname}/v${pkgver}/${pkgname}-${pkgver}.tar.xz"
)

sha256sums=(
    54b3f21123a531a6a536b9cdcc21344b0122a72790dbe4dacc98e64db25e4a24
)

build() {
    cd "${srcdir}/${pkgname}-${pkgver}"
    autoreconf -i
    mkdir build
    cd build
    CFLAGS+=' -fPIC' LDFLAGS='-Wl,-static' \
      ../configure --prefix=''
    MAKEFLAGS='' make V=1
}

package() {
    pkgfiles=(
        bin
        etc/mke2fs.conf
        sbin
    )
    cd "${srcdir}/${pkgbase}-${pkgver}/build"
    MAKEFLAGS='' make DESTDIR="${pkgdirbase}/dest" install
    cd "${pkgdirbase}/dest"
    set -o pipefail
    find ${pkgfiles[@]} | cpio -dumpv "$pkgdir"
}
